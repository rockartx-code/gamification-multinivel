<section class="antialiased">
  <header class="z-50 border-b border-white/5 bg-[#0b0f14]/85 backdrop-blur">
    <div class="mx-auto max-w-6xl px-6 py-4">
      <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-3">
            <img src="logo.png" alt="Logo findingU" class="h-15 w-40" />
          </div>

          <div class="flex items-center gap-2 lg:hidden">
            <button type="button"
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
              (click)="scrollToSection('merchant')">
              <i class="fa-solid fa-store" aria-hidden="true"></i>
              Tienda
            </button>
            <button *ngIf="!isGuest" type="button"
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
              (click)="scrollToSection('red')">
              <i class="fa-solid fa-users" aria-hidden="true"></i>
              Red
            </button>
          </div>
        </div>

        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4">

          <div *ngIf="currentUser" class="w-full rounded-3xl border border-white/10 bg-white/[0.03] px-5 py-4
            flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">

            <!-- Bloque izquierdo: Usuario -->
            <div class="flex items-start gap-3">
              <div
                class="mt-[2px] flex h-7 w-7 items-center justify-center rounded-full bg-white/5 border border-white/10">
                <i class="fa-solid fa-user text-zinc-300 text-sm" aria-hidden="true"></i>
              </div>

              <div>
                <div class="text-xs text-zinc-400">Usuario</div>
                <div class="text-lg font-semibold text-white leading-tight">{{ currentUser.name }}</div>
              </div>
            </div>

            <!-- Bloque derecho: pills (como en la imagen: lock arriba centrado, nivel oro abajo a la derecha) -->
            <div class="flex flex-col gap-2">

              <!-- Fila superior: pill lock centrado -->
              <div class="flex justify-end sm:justify-end">
                <span *ngIf="isClient" class="inline-flex items-end gap-2 rounded-full border border-white/10 bg-white/5
                   px-4 py-2 text-[11px] uppercase tracking-wide text-zinc-200">
                  <i class="fa-solid fa-lock text-zinc-300" aria-hidden="true"></i>
                  {{ discountBadgeText() }}
                </span>

                <!-- Si quieres que también soporte otros roles arriba, aquí -->
                <span *ngIf="currentUser.role !== 'cliente'" class="inline-flex items-center rounded-full border border-blue-400/20 bg-blue-500/10
                   px-4 py-2 text-[11px] uppercase tracking-wide text-blue-200">
                  {{ currentUser.role }}
                </span>
              </div>

              <!-- Fila inferior: nivel a la derecha -->
              <div class="flex justify-end">
                <span *ngIf="isClient" class="inline-flex items-center gap-2 rounded-full border border-yellow-400/30 bg-yellow-400/10
                   px-4 py-2 text-[11px] uppercase tracking-wide text-yellow-200">
                  <i class="fa-solid fa-medal" aria-hidden="true"></i>
                   {{ currentUser.level }}
                </span>
              </div>

            </div>
          </div>

          <nav class="hidden items-center gap-2 lg:flex">
            <button type="button"
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
              (click)="scrollToSection('merchant')">
              <i class="fa-solid fa-store" aria-hidden="true"></i>
              Tienda
            </button>
            <button *ngIf="!isGuest" type="button"
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
              (click)="scrollToSection('red')">
              <i class="fa-solid fa-users" aria-hidden="true"></i>
              Red
            </button>
            <button *ngIf="!isGuest" type="button"
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
              (click)="scrollToSection('links')">
              <i class="fa-solid fa-link" aria-hidden="true"></i>
              Links
            </button>

            <button *ngIf="!isGuest" type="button"
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
              (click)="logout()">
              <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i>
              Salir
            </button>
          </nav>

        </div>
      </div>

      <div class="mt-4 flex items-center justify-between" *ngIf="!isGuest">
        <div class="flex items-center gap-2 text-sm text-zinc-400">
          <i class="fa-solid fa-chart-line" aria-hidden="true"></i>
          Progreso mensual
        </div>

        <button
          class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
          (click)="toggleSecondaryGoals()">
          <i class="fa-solid fa-sliders" aria-hidden="true"></i>
          {{ secondaryGoalsVisible ? 'Ocultar metas secundarias' : 'Mostrar metas secundarias' }}
        </button>
      </div>

      <div class="mt-4" *ngIf="!isGuest && activeGoal">
        <div
          class="grain relative overflow-hidden rounded-3xl border border-yellow-400/40 bg-gradient-to-r from-yellow-400/20 via-orange-500/10 to-yellow-400/20 p-6 md:p-8"
          [id]="'goal-' + activeGoal.key">
          <div
            class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(245,185,66,0.25),transparent_60%)]">
          </div>
          <div class="absolute right-6 top-6 hidden rounded-2xl border border-white/10 bg-white/5 px-4 py-3 md:block"
            title="Cada dia sin accion reduce tu margen.">
            <div class="flex items-center gap-2 text-xs text-zinc-400">
              <i class="fa-solid fa-calendar-days" aria-hidden="true"></i>
              Corte de mes
            </div>
            <div class="text-lg font-extrabold tracking-tight" [ngClass]="getCountdownColor()">
              {{ countdownLabel() }}
            </div>

          </div>
          <div class="relative flex flex-col gap-5">
            <div class="md:pr-48">
              <div class="text-sm font-semibold text-yellow-200">&#x1F3AF; Objetivo principal del mes</div>
              <h3 class="mt-2 text-2xl font-extrabold tracking-tight md:text-3xl">{{ activeGoal.title }}</h3>
              <p class="mt-2 text-sm text-zinc-200">{{ activeGoal.subtitle }}</p>
              <div class="mt-3 text-sm text-yellow-100">Te faltan {{ remainingForGoal(activeGoal) }} para lograrlo</div>
              <div class="mt-4 h-3 overflow-hidden rounded-full bg-white/10">
                <div class="h-full bg-gradient-to-r from-yellow-300 to-orange-400"
                  [style.width.%]="goalBasePercent(activeGoal)"></div>
              </div>
            </div>
            <button type="button"
              class="glow-gold absolute bottom-6 right-6 inline-flex items-center justify-center gap-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 px-6 py-3 font-semibold text-black transition-transform hover:scale-[1.03]"
              (click)="scrollToSection(activeGoal.ctaFragment)">
              <i class="fa-solid fa-bullseye" aria-hidden="true"></i>
              {{ activeGoal.ctaText }}
            </button>
          </div>
        </div>
      </div>

      <div class="mt-3 grid gap-3 lg:grid-cols-4" *ngIf="!isGuest && secondaryGoalsVisible">
        <div *ngFor="let goal of secondaryGoals"
          class="grain relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-4 opacity-70"
          [id]="'goal-' + goal.key">
          <div class="goal-card" [attr.data-goal]="goal.key">
            <div class="text-xs text-zinc-400">{{ goal.subtitle }}</div>

            <div class="mt-3 flex items-center justify-between text-xs text-zinc-400">
              <span>{{ goalProgressLabel(goal) }}</span>
              <span *ngIf="goal.cart > 0" class="text-yellow-300">+{{ formatMoney(goal.cart) }} en carrito</span>
            </div>

            <div class="relative mt-2 h-3 overflow-hidden rounded-full progress-rail">
              <div class="progress-base absolute inset-y-0 left-0" [style.width.%]="goalBasePercent(goal)"></div>
              <div class="progress-cart absolute inset-y-0 left-0 opacity-90" [style.left.%]="goalBasePercent(goal)"
                [style.width.%]="goalCartPercent(goal)"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl space-y-16 px-6 py-10">
    <section id="merchant" class="scroll-mt-10">
      <div class="flex items-end justify-between gap-6">
        <div>
          <h2 class="flex items-center gap-3 text-3xl font-extrabold tracking-tight md:text-4xl">
            <i class="fa-solid fa-store text-yellow-200" aria-hidden="true"></i>
            Tienda
          </h2>
        </div>

        <div class="hidden items-center gap-3 md:flex">
          <div class="rounded-2xl border border-white/10 bg-white/5 px-4 py-3">
            <div class="flex items-center gap-2 text-xs text-zinc-400">
              <i class="fa-solid fa-cart-shopping" aria-hidden="true"></i>
              Carrito
            </div>
            <div class="text-lg font-extrabold">{{ formatMoney(cartTotal) }}</div>
          </div>
          <a class="glow-gold inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 px-5 py-3 font-semibold text-black transition-transform hover:scale-[1.03]"
            [routerLink]="['/carrito']">
            <i class="fa-solid fa-basket-shopping" aria-hidden="true"></i>
            Ver carrito
          </a>
        </div>
      </div>

      <div class="grain relative mt-8 overflow-hidden rounded-3xl border border-white/10 bg-ambient">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_75%_35%,rgba(245,185,66,0.18),transparent_55%)]">
        </div>
        <div class="relative grid items-center gap-8 p-6 md:grid-cols-2 md:p-10" *ngIf="productOfMonth as pom">
          <div>
            <span
              class="inline-flex items-center gap-2 rounded-full border border-yellow-400/20 bg-yellow-400/15 px-4 py-2 text-xs font-semibold text-yellow-200">
              <i class="fa-solid fa-star" aria-hidden="true"></i>
              Producto del mes ?? Recomendado para metas
            </span>
            <h3 class="mt-5 text-3xl font-extrabold tracking-tight md:text-4xl">{{ pom.name }}</h3>
            <p *ngIf="heroGoalHint" class="mt-2 text-sm text-yellow-200">{{ heroGoalHint }}</p>
            <p class="mt-3 max-w-xl text-zinc-300">
              {{ pom.hook || 'Producto recomendado para avanzar en tus metas.' }}
            </p>

            <div class="mt-6 flex flex-wrap gap-2">
              <span *ngFor="let tag of heroTags"
                class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm text-zinc-200">
                {{ tag }}
              </span>
            </div>

            <div class="mt-8 flex flex-col gap-3 sm:flex-row sm:items-center">
              <div class="flex items-center gap-3 rounded-2xl border border-white/10 bg-[#121826] p-3">
                <span class="text-sm text-zinc-400">Cantidad</span>
                <input type="number" min="0" [value]="heroQty" (input)="setHeroQty($any($event.target).value)"
                  class="w-20 rounded-xl border border-white/10 bg-black/20 px-3 py-2 text-sm text-white" />
                <span class="text-sm text-zinc-400">x {{ formatMoney(heroProductPrice) }}</span>
              </div>

              <button
                class="glow-blue inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 px-6 py-3 font-semibold transition-transform hover:scale-[1.03]"
                (click)="addHeroToCart()">
                <i class="fa-solid fa-cart-plus" aria-hidden="true"></i>
                Agregar al carrito
              </button>
            </div>
          </div>

          <div class="relative h-[260px] overflow-hidden rounded-3xl border border-white/10 md:h-[360px]">
            <img [src]="heroImage" [alt]="pom.name" class="hero-image absolute inset-0 h-full w-full object-cover" />
            <div class="absolute inset-0 bg-gradient-to-tr from-[#0b0f14]/70 via-transparent to-transparent"></div>
            <div class="absolute -right-16 -top-16 h-64 w-64 rounded-full bg-yellow-400/10 blur-3xl"></div>

            <div class="relative flex h-full flex-col justify-end p-6">
              <div class="text-sm font-semibold text-zinc-200">Oferta estrat?gica</div>
              <div class="mt-1 text-xs text-zinc-400">Optimiza tu corte de mes</div>
            </div>
          </div>
        </div>
        <div class="relative grid items-center gap-8 p-6 md:grid-cols-2 md:p-10" *ngIf="!productOfMonth">
          <div>
            <span
              class="inline-flex items-center gap-2 rounded-full border border-yellow-400/20 bg-yellow-400/15 px-4 py-2 text-xs font-semibold text-yellow-200">
              <i class="fa-solid fa-star" aria-hidden="true"></i>
              Producto del mes
            </span>
            <h3 class="mt-5 text-3xl font-extrabold tracking-tight md:text-4xl">Producto destacado</h3>
            <p class="mt-3 max-w-xl text-zinc-300">
              A?n no hay un producto del mes configurado.
            </p>
          </div>
        </div>
      </div>

      <div class="mt-10">
        <div class="flex items-center justify-between">
          <h3 class="flex items-center gap-2 text-xl font-bold">
            <i class="fa-solid fa-rotate text-blue-200" aria-hidden="true"></i>
            Volver a comprar
          </h3>
          <p class="text-sm text-zinc-400">Tus básicos para mantener metas constantes.</p>
        </div>
        <div class="mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          <article *ngFor="let product of buyAgainProducts"
            class="relative overflow-hidden rounded-3xl border border-white/10 bg-[#121826] p-5 transition-shadow hover:shadow-[0_0_70px_rgba(59,130,246,0.18)]">
            <div
              class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_70%_30%,rgba(59,130,246,0.10),transparent_55%)]">
            </div>

            <div class="relative flex gap-4">
              <div
                class="flex h-20 w-20 shrink-0 items-center justify-center overflow-hidden rounded-2xl border border-white/10 bg-white/5">
                <img [src]="product.img" [alt]="product.name" class="h-full w-full object-cover" />
              </div>

              <div class="min-w-0 flex-1">
                <div class="flex items-start justify-between gap-3">
                  <div class="min-w-0">
                    <div class="text-xs text-zinc-400">Producto</div>
                    <h4 class="mt-1 truncate font-extrabold tracking-tight">{{ product.name }}</h4>
                    <div class="mt-1 truncate text-xs text-zinc-500">{{ product.badge }}</div>
                  </div>
                  <div class="whitespace-nowrap text-sm font-extrabold">{{ formatMoney(product.price) }}</div>
                </div>

                <div class="mt-4 flex items-center gap-3">
                  <div class="flex items-center gap-2 rounded-2xl border border-white/10 bg-black/20 px-3 py-2">
                    <span class="text-xs text-zinc-400">Qty</span>
                    <input type="number" min="0" [value]="getCartQty(product.id)"
                      (input)="updateCart(product.id, $any($event.target).value)"
                      class="w-14 rounded-xl border border-white/10 bg-transparent px-2 py-1 text-sm text-white" />
                  </div>

                  <button
                    class="glow-blue inline-flex flex-1 items-center justify-center gap-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 px-5 py-2.5 text-sm font-semibold transition-transform hover:scale-[1.02]"
                    (click)="addQuick(product.id, 1)">
                    <i class="fa-solid fa-cart-plus" aria-hidden="true"></i>
                    Agregar
                  </button>
                </div>
              </div>
            </div>

            <div class="relative mt-3 flex items-center justify-between text-xs text-zinc-500">
              <button class="inline-flex items-center gap-2 transition hover:text-zinc-200"
                (click)="notifyAction('Detalle de producto (hook)')">
                <i class="fa-solid fa-circle-info" aria-hidden="true"></i>
                Ver detalle
              </button>
              <button class="inline-flex items-center gap-2 transition hover:text-zinc-200"
                (click)="notifyAction('Comparar (hook)')">
                <i class="fa-solid fa-scale-balanced" aria-hidden="true"></i>
                Comparar
              </button>
            </div>
          </article>
        </div>
      </div>

      <div class="mt-12">
        <div class="flex items-center justify-between">
          <h3 class="flex items-center gap-2 text-xl font-bold">
            <i class="fa-solid fa-layer-group text-blue-200" aria-hidden="true"></i>
            Todos los productos
          </h3>
          <div class="text-sm text-zinc-400">{{ productsCount }}</div>
        </div>
        <div class="mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          <article *ngFor="let product of otherProducts"
            class="relative overflow-hidden rounded-3xl border border-white/10 bg-[#121826] p-5 transition-shadow hover:shadow-[0_0_70px_rgba(59,130,246,0.18)]">
            <div
              class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_70%_30%,rgba(59,130,246,0.10),transparent_55%)]">
            </div>

            <div class="relative flex gap-4">
              <div
                class="flex h-20 w-20 shrink-0 items-center justify-center overflow-hidden rounded-2xl border border-white/10 bg-white/5">
                <img [src]="product.img" [alt]="product.name" class="h-full w-full object-cover" />
              </div>

              <div class="min-w-0 flex-1">
                <div class="flex items-start justify-between gap-3">
                  <div class="min-w-0">
                    <div class="text-xs text-zinc-400">Producto</div>
                    <h4 class="mt-1 truncate font-extrabold tracking-tight">{{ product.name }}</h4>
                    <div class="mt-1 truncate text-xs text-zinc-500">{{ product.badge }}</div>
                  </div>
                  <div class="whitespace-nowrap text-sm font-extrabold">{{ formatMoney(product.price) }}</div>
                </div>

                
              </div>
            </div>

            <div class="relative mt-3 flex items-center justify-between text-xs ">
              <div class="mt-4 flex items-center gap-3">
                  <div class="flex items-center gap-2 rounded-2xl border border-white/10 bg-black/20 px-3 py-2">
                    <span class="text-xs text-zinc-400">Qty</span>
                    <input type="number" min="0" [value]="getCartQty(product.id)"
                      (input)="updateCart(product.id, $any($event.target).value)"
                      class="w-14 rounded-xl border border-white/10 bg-transparent px-2 py-1 text-sm text-white" />
                  </div>

                  <button
                    class="glow-blue inline-flex flex-1 items-center justify-center gap-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 px-5 py-2.5 text-sm font-semibold transition-transform hover:scale-[1.02]"
                    (click)="addQuick(product.id, 1)">
                    <i class="fa-solid fa-cart-plus" aria-hidden="true"></i>
                    Agregar
                  </button>
                </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section id="red" class="scroll-mt-10" *ngIf="!isGuest">
      <div class="flex items-end justify-between gap-6">
        <div>
          <h2 class="flex items-center gap-3 text-3xl font-extrabold tracking-tight md:text-4xl">
            <i class="fa-solid fa-users text-blue-200" aria-hidden="true"></i>
            Red
          </h2>
        </div>
        <button type="button"
          class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-5 py-3 transition hover:bg-white/10"
          (click)="scrollToSection('links')">
          <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
          Compartir enlaces
        </button>
      </div>

      <div class="mt-8 grid gap-6 lg:grid-cols-2">
        <div class="grain relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6">
          <div
            class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_40%_20%,rgba(59,130,246,0.12),transparent_55%)]">
          </div>
          <div class="relative flex items-center justify-between">
            <div>
              <h3 class="flex items-center gap-2 text-xl font-bold">
                <i class="fa-solid fa-users" aria-hidden="true"></i>
                Tu Red
              </h3>
            </div>
          </div>

          <div class="mt-6 overflow-hidden rounded-2xl border border-white/10 bg-[#121826] p-4">
            <svg viewBox="0 0 560 260" class="h-[260px] w-full">
              <g stroke="rgba(255,255,255,.18)" stroke-width="2">
                <line *ngFor="let link of graphLayout.links" [attr.x1]="link.x1" [attr.y1]="link.y1" [attr.x2]="link.x2"
                  [attr.y2]="link.y2"></line>
              </g>

              <g>
                <ng-container *ngFor="let node of graphLayout.nodes">
                  <circle [attr.cx]="node.x" [attr.cy]="node.y" [attr.r]="nodeRadius(node.level)"
                    [attr.fill]="nodeFill(node.level, node.status)">
                    <title>{{ node.name }}</title>
                  </circle>
                  <text [attr.x]="node.x" [attr.y]="node.y + (node.level === 'root' ? 5 : 4)" text-anchor="middle"
                    [attr.font-size]="node.level === 'root' ? 12 : (node.level === 'L1' ? 11 : 10)" fill="#0b0f14"
                    [attr.font-weight]="node.level === 'L2' ? 800 : 700">{{ node.label }}</text>
                </ng-container>
              </g>
            </svg>

          </div>

          <div *ngIf="hasInactiveIntermediate"
            class="mt-4 rounded-2xl border border-yellow-400/30 bg-yellow-400/10 px-4 py-3 text-xs text-yellow-100">
            <i class="fa-solid fa-handshake-angle" aria-hidden="true"></i>
            Apoya a tu red: cuando hay inactivos en niveles plata, los beneficios de sus bronce no llegan hasta ti.
          </div>

          <button *ngIf="levelOneCount === 0 && levelTwoCount === 0" type="button"
            class="mt-4 inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
            (click)="scrollToSection('links')">
            <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
            Compartir mi enlace
          </button>

          <div class="mt-4 grid grid-cols-3 gap-3 text-sm">
            <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
              <div class="text-xs text-zinc-400">Nivel 1</div>
              <div class="mt-1 text-2xl font-extrabold">{{ levelOneCount }}</div>
            </div>
            <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
              <div class="text-xs text-zinc-400">Nivel 2</div>
              <div class="mt-1 text-2xl font-extrabold">{{ levelTwoCount }}</div>
            </div>
            <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
              <div class="text-xs text-zinc-400">Activos</div>
              <div class="mt-1 text-2xl font-extrabold">{{ activeCount }}</div>
            </div>
          </div>
        </div>

        <div class="grain relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6">
          <div
            class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_70%_20%,rgba(245,185,66,0.12),transparent_55%)]">
          </div>
          <div class="relative">
            <div *ngIf="networkMembers.length === 0"
              class="mb-6 rounded-2xl border border-yellow-400/30 bg-yellow-400/10 p-5">
              <div class="text-sm font-semibold text-yellow-200">&#x1F3AF; Misi&#243;n de red</div>
              <div class="mt-2 text-lg font-extrabold">Invita a 1 persona y act&#237;vala este mes</div>
              <div class="mt-1 text-sm text-zinc-200/90">Tu red se activa con tu primer miembro.</div>
              <div class="mt-4 flex flex-wrap gap-2">
                <button type="button"
                  class="glow-gold inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 px-4 py-2 text-sm font-semibold text-black transition-transform hover:scale-[1.03]"
                  (click)="copyLinkAndCopy()">
                  <i class="fa-solid fa-copy" aria-hidden="true"></i>
                  Copiar link + copy
                </button>
                <button type="button"
                  class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                  (click)="scrollToSection('links')">
                  <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                  Compartir mi enlace
                </button>
                <button type="button"
                  class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                  (click)="scrollToSection('links')">
                  <i class="fa-solid fa-comment-dots" aria-hidden="true"></i>
                  Ver mensajes sugeridos
                </button>
              </div>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <h3 class="flex items-center gap-2 text-xl font-bold">
                  <i class="fa-solid fa-chart-column" aria-hidden="true"></i>
                  Consumo mensual de tu red
                </h3>
              </div>
              <button type="button"
                class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-2 text-xs text-zinc-300 transition hover:bg-white/10"
                (click)="scrollToSection('links')">
                <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                Compartir enlaces
              </button>
            </div>

            <div *ngIf="networkMembers.length === 0"
              class="mt-6 rounded-2xl border border-white/10 bg-[#121826] p-6 text-center">
              <div class="text-sm font-semibold text-zinc-200">A?n no tienes miembros en tu red</div>
              <div class="mt-1 text-xs text-zinc-400">Comparte tu enlace para empezar</div>
              <button type="button"
                class="mt-4 inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                (click)="scrollToSection('links')">
                <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                Compartir mi enlace
              </button>
            </div>

            <div *ngIf="networkMembers.length > 0" class="mt-6 overflow-hidden rounded-2xl border border-white/10">
              <table class="w-full text-sm">

                <thead class="bg-white/5 text-zinc-300">
                  <tr>
                    <th class="px-4 py-3 text-left font-semibold">Usuario</th>
                    <th class="px-4 py-3 text-left font-semibold">Nivel</th>
                    <th class="px-4 py-3 text-left font-semibold">Consumo mes</th>
                    <th class="px-4 py-3 text-left font-semibold">Estado</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-white/5 text-zinc-200">
                  <tr *ngFor="let member of networkMembers">
                    <td class="px-4 py-3">{{ member.name }}</td>
                    <td class="px-4 py-3 text-zinc-300">{{ member.level }}</td>
                    <td class="px-4 py-3">{{ formatMoney(member.spend) }}</td>
                    <td class="px-4 py-3">
                      <span class="rounded-full border px-3 py-1 text-xs" [ngClass]="statusBadgeClass(member.status)">{{
                        member.status }}</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="mt-6 rounded-2xl border border-white/10 bg-[#121826] p-5">
              <div class="flex items-center justify-between">
                <div>
                  <div class="text-xs text-zinc-400">Meta de red (este mes)</div>
                  <div class="mt-1 text-lg font-extrabold">
                    {{ formatMoney(networkProgress) }} / {{ formatMoney(networkGoal) }}
                  </div>
                  <div class="mt-1 text-xs text-zinc-400">Te faltan {{ formatMoney(remainingNetworkGoal) }} para cumplir
                    la meta de red</div>
                </div>
                <button type="button"
                  class="glow-gold inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 px-5 py-3 text-sm font-semibold text-black transition-transform hover:scale-[1.03]"
                  (click)="scrollToSection('links')">
                  <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                  Compartir mi enlace
                </button>
              </div>

              <div class="progress-rail relative mt-4 h-3 overflow-hidden rounded-full">
                <div class="progress-base absolute inset-y-0 left-0" [style.width.%]="networkPercent"></div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="links" class="scroll-mt-10" *ngIf="!isGuest">
      <div class="flex items-end justify-between gap-6">
        <div>
          <h2 class="flex items-center gap-3 text-3xl font-extrabold tracking-tight md:text-4xl">
            <i class="fa-solid fa-link text-yellow-200" aria-hidden="true"></i>
            Links de referencia
          </h2>
        </div>
        <button type="button"
          class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-5 py-3 transition hover:bg-white/10"
          (click)="scrollToSection('merchant')">
          <i class="fa-solid fa-store" aria-hidden="true"></i>
          Ver productos
        </button>
      </div>

      <div class="mt-8 grid gap-6 lg:grid-cols-1">
        <div class="grain relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6">
          <div
            class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_35%_20%,rgba(59,130,246,0.12),transparent_55%)]">
          </div>



          <div *ngIf="networkMembers.length === 0"
            class="mb-6 rounded-2xl border border-yellow-400/30 bg-yellow-400/10 p-5">
            <div class="text-sm font-semibold text-yellow-200">&#x1F3AF; Misi&#243;n de red</div>
            <div class="mt-2 text-lg font-extrabold">Invita a 1 persona y act&#237;vala este mes</div>
            <div class="mt-1 text-sm text-zinc-200/90">Tu red se activa con tu primer miembro.</div>
            <div class="mt-4 flex flex-wrap gap-2">
              <button type="button"
                class="glow-gold inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 px-4 py-2 text-sm font-semibold text-black transition-transform hover:scale-[1.03]"
                (click)="copyLinkAndCopy()">
                <i class="fa-solid fa-copy" aria-hidden="true"></i>
                Copiar link + copy
              </button>
              <button type="button"
                class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                (click)="scrollToSection('links')">
                <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                Compartir mi enlace
              </button>
              <button type="button"
                class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                (click)="scrollToSection('links')">
                <i class="fa-solid fa-comment-dots" aria-hidden="true"></i>
                Ver mensajes sugeridos
              </button>
            </div>
          </div>

          <div class="mb-6 rounded-2xl border border-white/10 bg-[#121826] p-4">
            <div class="flex items-center gap-2 text-xs font-semibold text-zinc-400">
              <i class="fa-solid fa-route" aria-hidden="true"></i>
              Tu flujo de 3 pasos
            </div>
            <div class="mt-3 space-y-3 text-sm">
              <div class="flex items-center gap-3">
                <div class="flex h-8 w-8 items-center justify-center rounded-full border text-sm font-semibold"
                  [ngClass]="activeFeaturedId ? 'border-emerald-400/40 bg-emerald-500/10 text-emerald-200' : 'border-white/10 bg-white/5 text-zinc-300'">
                  <i *ngIf="activeFeaturedId" class="fa-solid fa-check" aria-hidden="true"></i>
                  <span *ngIf="!activeFeaturedId">1</span>
                </div>
                <div>
                  <div class="font-semibold text-zinc-200">Elige gancho</div>
                  <div class="text-xs text-zinc-500">Selecciona tu producto destacado.</div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="flex h-8 w-8 items-center justify-center rounded-full border text-sm font-semibold"
                  [ngClass]="hasCopiedLink ? 'border-emerald-400/40 bg-emerald-500/10 text-emerald-200' : 'border-white/10 bg-white/5 text-zinc-300'">
                  <i *ngIf="hasCopiedLink" class="fa-solid fa-check" aria-hidden="true"></i>
                  <span *ngIf="!hasCopiedLink">2</span>
                </div>
                <div>
                  <div class="font-semibold text-zinc-200">Copia tu link</div>
                  <div class="text-xs text-zinc-500">Pegalo en tu bio o chat.</div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="flex h-8 w-8 items-center justify-center rounded-full border text-sm font-semibold"
                  [ngClass]="(hasCopiedCopy || hasCopiedAsset) ? 'border-emerald-400/40 bg-emerald-500/10 text-emerald-200' : 'border-white/10 bg-white/5 text-zinc-300'">
                  <i *ngIf="hasCopiedCopy || hasCopiedAsset" class="fa-solid fa-check" aria-hidden="true"></i>
                  <span *ngIf="!(hasCopiedCopy || hasCopiedAsset)">3</span>
                </div>
                <div>
                  <div class="font-semibold text-zinc-200">Publica</div>
                  <div class="text-xs text-zinc-500">Copy + creatividades listas.</div>
                </div>
              </div>
            </div>
          </div>

          <div class="relative">
            <h3 class="flex items-center gap-2 text-xl font-bold">
              <i class="fa-solid fa-bullseye" aria-hidden="true"></i>
              Selecciona tu gancho
            </h3>

            <div class="mt-5 grid gap-3 sm:grid-cols-2">
              <button *ngFor="let item of pagedFeatured"
                class="rounded-2xl border p-4 text-left transition hover:bg-white/10" (click)="setFeatured(item.id)"
                [ngClass]="
                  item.id === activeFeaturedId
                    ? 'border-blue-400/40 bg-blue-500/10'
                    : 'border-white/10 bg-white/5'
                ">
                <div class="text-xs text-zinc-400">Gancho</div>
                <div class="mt-1 font-extrabold tracking-tight">{{ item.label }}</div>
                <div class="mt-2 text-xs text-zinc-400">{{ item.hook }}</div>
              </button>
            </div>

            <div class="mt-4 flex items-center justify-between">
              <button type="button"
                class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                [disabled]="!canPrevFeatured" [ngClass]="!canPrevFeatured ? 'opacity-50 cursor-not-allowed' : ''"
                (click)="prevFeaturedPage()">
                <i class="fa-solid fa-chevron-left" aria-hidden="true"></i>
                Atras
              </button>
              <button type="button"
                class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                [disabled]="!canNextFeatured" [ngClass]="!canNextFeatured ? 'opacity-50 cursor-not-allowed' : ''"
                (click)="nextFeaturedPage()">
                Siguiente
                <i class="fa-solid fa-chevron-right" aria-hidden="true"></i>
              </button>
            </div>

            <div class="mt-6 rounded-2xl border border-white/10 bg-[#121826] p-4">
              <div class="flex items-center gap-2 text-xs text-zinc-400">
                <i class="fa-solid fa-link" aria-hidden="true"></i>
                Tu link
              </div>
              <div class="mt-2 flex flex-col gap-3 sm:flex-row">
                <input readonly [value]="referralLink"
                  class="flex-1 rounded-2xl border border-white/10 bg-black/20 px-4 py-3 text-sm text-zinc-200" />
                <div class="flex flex-1 flex-col gap-2 sm:flex-row sm:justify-end">
                  <button
                    class="glow-blue inline-flex items-center justify-center gap-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 px-5 py-3 font-semibold transition-transform hover:scale-[1.03]"
                    (click)="copyLink()">
                    <i class="fa-solid fa-copy" aria-hidden="true"></i>
                    Copiar
                  </button>
                </div>
              </div>
              <div class="mt-2 text-xs text-zinc-500">
                Tip: fija el link en tu bio y rep&#237;telo en 3 historias.
              </div>
            </div>
          </div>
          <div class="relative mt-6">

            <div class="flex items-center justify-between">
              <div>
                <h3 class="flex items-center gap-2 text-xl font-bold">
                  <i class="fa-brands fa-instagram" aria-hidden="true"></i>
                  Previsualizaciones sociales
                </h3>
                <p class="mt-1 text-sm text-zinc-400">Mockups (reemplaza imágenes por tus creatividades).</p>
              </div>

              <div class="flex flex-wrap gap-2">
                <button
                  class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                  [ngClass]="socialChannel === 'whatsapp' ? 'border-blue-400/30 bg-blue-500/10' : ''"
                  (click)="setChannel('whatsapp')">
                  <i class="fa-brands fa-whatsapp" aria-hidden="true"></i>
                  WhatsApp
                </button>
                <button
                  class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                  [ngClass]="socialChannel === 'instagram' ? 'border-blue-400/30 bg-blue-500/10' : ''"
                  (click)="setChannel('instagram')">
                  <i class="fa-brands fa-instagram" aria-hidden="true"></i>
                  Instagram
                </button>
                <button
                  class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm transition hover:bg-white/10"
                  [ngClass]="socialChannel === 'facebook' ? 'border-blue-400/30 bg-blue-500/10' : ''"
                  (click)="setChannel('facebook')">
                  <i class="fa-brands fa-facebook-f" aria-hidden="true"></i>
                  Facebook
                </button>
              </div>
            </div>

            <div class="mt-6 grid gap-4 md:grid-cols-2">
              <div class="overflow-hidden rounded-2xl border border-white/10 bg-[#121826]">
                <div class="bg-white/5 px-4 py-3 text-sm font-semibold text-zinc-200">
                  Optimizado para {{ socialChannel === 'whatsapp' ? 'WhatsApp' : (socialChannel === 'instagram' ?
                  'Instagram' : 'Facebook') }}
                </div>
                <div class="p-4">
                  <div class="bg-ambient relative w-full overflow-hidden rounded-2xl border border-white/10"
                    [style.aspect-ratio]="socialAspectRatio">
                    <img [src]="activeSocialAsset" alt="Social"
                      class="hero-image absolute inset-0 h-full w-full object-cover" />
                    <div class="absolute inset-0 bg-gradient-to-tr from-[#0b0f14]/70 via-transparent to-transparent">
                    </div>
                    <div class="absolute bottom-0 left-0 right-0 p-4">
                      <div class="text-xs font-semibold text-zinc-200/90">OBTENERLO AHORA</div>
                      <div class="text-lg font-extrabold leading-tight">{{ activeFeatured.label }}</div>
                      <div class="mt-1 text-xs text-zinc-300">Link en bio / swipe up</div>
                    </div>
                  </div>

                  <div class="mt-4 flex items-center justify-between gap-3">
                    <!--div class="text-xs text-zinc-500">
                      Imagen: <span class="text-zinc-300">{{ activeSocialAsset }}</span>
                    </div-->
                    <button
                      class="glow-gold inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 px-4 py-2 text-sm font-semibold text-black transition-transform hover:scale-[1.03]"
                      (click)="copyAssetPath()">
                      <i class="fa-solid fa-copy" aria-hidden="true"></i>
                      Copiar ruta
                    </button>
                  </div>
                </div>
              </div>



              <div class="rounded-2xl border border-white/10 bg-[#121826] p-4">
                <div class="flex items-center gap-2 text-sm font-semibold text-zinc-200">
                  <i class="fa-solid fa-pen-nib" aria-hidden="true"></i>
                  {{ socialChannel === 'instagram' ? 'Descripción sugerida (editable)' : (socialChannel === 'facebook' ?
                  'Comentario sugerido (editable)' : 'Mensaje sugerido (editable)') }}
                </div>
                <textarea rows="10"
                  class="mt-3 w-full rounded-2xl border border-white/10 bg-black/20 px-4 py-3 text-sm text-zinc-200 placeholder:text-zinc-500"
                  placeholder="Escribe tu copy aquí..." [(ngModel)]="captionText"
                  (ngModelChange)="lastAutoCaption = false"></textarea>
                <div class="mt-3 flex gap-3">
                  <button
                    class="glow-blue inline-flex flex-1 items-center justify-center gap-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 px-5 py-3 font-semibold transition-transform hover:scale-[1.03]"
                    (click)="copyCaption()">
                    <i class="fa-solid fa-copy" aria-hidden="true"></i>
                    {{ socialChannel === 'instagram' ? 'Copiar descripción' : (socialChannel === 'facebook' ? 'Copiar
                    comentario' : 'Copiar mensaje') }}
                  </button>
                  <!--button
                    class="inline-flex flex-1 items-center justify-center gap-2 rounded-full border border-white/10 bg-white/5 px-5 py-3 transition hover:bg-white/10"
                    (click)="generateTemplate()">
                    <i class="fa-solid fa-wand-magic-sparkles" aria-hidden="true"></i>
                    Generar template
                  </button-->
                </div>
                <div class="mt-2 text-xs text-zinc-500">
                  Recomendación UX: 1 promesa + 1 prueba + 1 CTA. Evita promesas financieras.
                </div>
              </div>
            </div>

          </div>
        </div>


      </div>
    </section>
  </main>

  <div class="fixed bottom-5 left-1/2 z-50 -translate-x-1/2" [class.hidden]="!isToastVisible">
    <div
      class="rounded-full border border-white/10 bg-[#121826] px-5 py-3 text-sm text-zinc-200 shadow-[0_20px_60px_rgba(0,0,0,0.6)]">
      {{ toastMessage }}
    </div>
  </div>


  <footer class="border-t border-white/5 bg-[#0b0f14]">
    <div
      class="mx-auto flex max-w-6xl flex-col items-start justify-between gap-6 px-6 py-10 md:flex-row md:items-center">
      <img src="logo.png" alt="Logo findingU" class="h-15 w-40" />

      <div class="flex flex-col items-start gap-3 md:items-end">
        <div class="text-xs text-zinc-500">© 2026 finding U</div>
      </div>
    </div>
  </footer>
</section>